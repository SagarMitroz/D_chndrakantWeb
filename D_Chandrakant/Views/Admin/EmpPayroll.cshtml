@model D_Chandrakant.Models.EmpSalViewModel
@{
  
    Layout = "_Layout";
    
    var sr = 1;
}


<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>D.Chandrakant Tailors </title>
   
  
  
  
   
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Public+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap"
          rel="stylesheet" />
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <link href="https://cdn.datatables.net/1.10.12/css/jquery.dataTables.css" rel="stylesheet" />
    <link href="https://cdn.datatables.net/buttons/1.2.2/css/buttons.dataTables.css" rel="stylesheet" />
    <link rel="shortcut icon" type="image/png" class="bg-black" href="../assets/images/logos/Favicon.png" />
    <link rel="stylesheet" href="../assets/css/styles.min.css" />
    <link rel="stylesheet" href="../assets/css/bootstrap.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <script src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    @* <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.bundle.min.js"></script> *@
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>
    <script src="https://code.jquery.com/ui/1.13.0/jquery-ui.js"></script>
    <script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.js"></script>
    <script src="https://cdn.datatables.net/1.10.16/js/jquery.dataTables.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.32/pdfmake.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.32/vfs_fonts.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.4.2/js/dataTables.buttons.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.4.2/js/buttons.html5.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.2.1/js/buttons.print.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.3/jquery.validate.min.js"></script>



    <style>
        tbody, td, tfoot, th, thead, tr {
            border-color: #e9e9e9 !important;
        }

        table.dataTable.no-footer {
            border-color: #e9e9e9 !important;
        }

        .headerrow {
            background: #dae1e5;
            height: 60px;
            vertical-align: middle;
        }

        .center-buttons {
            display: flex;
            justify-content: center;
        }

        .dataTables_wrapper .dataTables_filter input {
            margin-left: 0.5em;
            border-radius: 20px;
            height: 35px;
            outline-offset: 0px;
            padding: 10px;
            border: 2px solid #bdbdbd;
        }


        .dataTables_wrapper .dataTables_paginate .paginate_button.current, .dataTables_wrapper .dataTables_paginate .paginate_button.current:hover {
            color: #333 !important;
            border-radius: 20px;
            border: 0px solid #979797;
            background: #ffe1e1;
        }

        table.dataTable tbody th, table.dataTable tbody td {
            padding: 15px 10px;
        }

        .menu-submenu {
            transition: max-height 0.3s ease-in-out;
            max-height: 0;
            overflow: hidden;
        }

            .menu-submenu.show {
                max-height: 500px; /* Adjust as needed */
            }

        .pagination {
            justify-content: center;
        }

        .profile-link {
            cursor: pointer;
        }
    </style>
</head>

<body class="bg-light-primary">


   

    <div class="container-fluid">
        <main role="main" class="pb-3">

    <section class="Emp-management mb-4">
        <header class="container-fluid">
            <div class="row">
                <div class="col-6">
                    <h2 class="ml-2">Pay on work Employee</h2>
                </div>
                <div class="col-12 mt-2 mb-2" style="display:flex;">
                            <div class="col-3" id="reportrange" style="background: #fff; cursor: pointer; padding: 5px 10px; border: 1px solid #ccc; width: ;">
                                <i class="bi bi-calendar3"></i>&nbsp;
                                <span id="dggf"></span> <i class="fa fa-caret-down"></i>
                            </div>

                           

                            <div class="col-1">

                                <button id="searchButton" type="submit" class="btn btn-primary" style="margin-top: -1px;">Search</button>
                            </div>

                    
                   @*  Select date
                    <input type="date" id="selectedDate" /> *@
                </div>
               @*  <div class="col-6 mt-2 mb-2">
                    <div style="display: flex; justify-content: flex-end;">
                        <div class="dropdown">
                            <div class="mr-2" style="display: flex; justify-content: flex-end;">
                                <form class="d-flex ">
                                    Start Date:
                                    <input type="date" id="selectedDate1" /> To
                                    End Date:
                                    <input type="date" id="selectedDate2" />
                                    <button onclick="generate()" class="btn  border-primary rounded-pill bg-primary text-white w-30 "
                                            type="button">
                                        Generate
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div> *@
            </div>


            </div>
        </header>
        </div>
        </div>
    </section>






    @* <section class="Emp-management mb-4">
        <header class="container-fluid">
            <div class="row">
                <div class="col-md-3 mt-2 mb-2">
                    <form id="monthlyReportForm">
                        <div class="form-group">
                            <label for="selectedDate1">Start Date:</label>
                            <input type="date" id="selectedDate1" name="selectedDate1" class="form-control">
                        </div>
                    </form>
                </div>

                <div class="col-md-3 mt-2 mb-2">
                    <div class="form-group">
                        <label for="selectedDate2">End Date:</label>
                        <input type="date" id="selectedDate2" name="selectedDate2" class="form-control">
                    </div>
                </div>

                <div class="col-3 mt-2 mb-2" ">
                    <div class="form-group">
                        <button class="btn  border-primary rounded-pill bg-primary text-white w-30" style="margin-top: 34px;" type="button" onclick="generate()">Get Report</button>

                    </div>
                </div>



            </div>


        </header>
       
    </section>
 *@



    <section class="section-table">
        <section class="container-fluid">
           @*  <div class="row"> *@
                @* <div class="card  w-100" "> *@
                   @*  <div class="card w-100"> *@
                        <div id="tab2Content" class="tab-content mt-4">
                            <div class="card" style="padding: 30px;box-shadow:0 7px 10px 10px rgb(7 38 72 / 12%);">
                                <table class="table" id="example" style="text-align:center;">
                                    <thead>
                            <tr style="background-color: #E1E2FF;">
                                            <th>Sr No</th>
                                            <th>Name</th>
                                            
                                            <th>Employee Type</th>
                                            <th>ID No</th>
                                            <th>Department</th>
                                             <th>Account No</th>
                                            <th>Qty</th>
                                            <th>Salary</th>

                                        </tr>
                                    </thead>
                                    <tbody id="examplet">
                            @if (Model.salaries.Count > 0)
                            {
                                @foreach (var item in Model.salaries)
                                {
                                                <tr>
                                                    <td>@sr</td>
                                                    <td>@item.Name</td>
                                                    <td>@item.EmpType</td>
                                                    <td>@item.Id</td>
                                                    <td>@item.DeptName</td>
                                                     <td>@item.AccountNo</td>
                                                     <td>@item.ComOrder</td>
                                                    <td>@item.Salary</td>

                                                </tr>
                                    sr++;
                                }

                            }
                                    </tbody>
                                </table>
                            </div>

                       @*  </div> *@
                   @*  </div> *@
               @*  </div> *@


        </section>
    </section>



    </div>
    </main>
    </div>

    
    <script src="~/assets/libs/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    

    


 

    <script>
        $(document).ready(function () {

            var start = moment().subtract(29, 'days');
            var end = moment();

            function cb(start, end) {
                $('#reportrange span').html(start.format(' DD/MM/YYYY') + ' - ' + end.format(' DD/MM/YYYY'));
            }

            $('#reportrange').daterangepicker({

                startDate: start,
                endDate: end,
                ranges: {
                    'Today': [moment(), moment()],
                    'Yesterday': [moment().subtract(1, 'days'), moment().subtract(1, 'days')],
                    'Last 7 Days': [moment().subtract(6, 'days'), moment()],
                    'Last 30 Days': [moment().subtract(29, 'days'), moment()],
                    'This Month': [moment().startOf('month'), moment().endOf('month')],
                    'Last Month': [moment().subtract(1, 'month').startOf('month'), moment().subtract(1, 'month').endOf('month')]
                }
            }, cb);

            cb(start, end);

        });
    </script>

    <script>

        $(document).ready(function () {
            $("#searchButton").click(function () {
                // Retrieve selected date range
                var dateRange = $("#dggf").text().trim();

                // Split the date range into start and end dates
                var dates = dateRange.split("-");
                var startDate = dates[0].trim();
                var endDate = dates[1].trim();

                // Retrieve product value (assuming product is defined somewhere else in your script)
                var product = $("#product").val(); // Make sure to replace #product with the actual selector for your product element

                $.ajax({
                    type: "POST",
                    url: '/Admin/EmpPayrollJ', // Ensure this URL is correct
                    data: {
                        startDate: startDate,
                        endDate: endDate,
                        itemfk: product,
                    },
                    success: function (response) {
                        console.log(response);
                        if ($.fn.DataTable.isDataTable('#example')) {
                            $('#example').DataTable().destroy();
                        }
                        $('#example tbody').empty(); // Clear the table body (assuming the table body has an id of 'example')

                        response.salaries.forEach(function (item, index) {
                            var row = '<tr>' +
                                '<td>' + (index + 1) + '</td>' + // Serial Number
                                '<td>' + item.name + '</td>' + // Name
                                '<td>' + item.empType + '</td>' + // Employee Type
                                '<td>' + item.id + '</td>' + // ID
                                '<td>' + item.deptName + '</td>' + // Department Name
                                '<td>' + item.accountNo + '</td>' + // Account Number
                                '<td>' + item.comOrder + '</td>' + // Com Order
                                '<td>' + item.salary + '</td>' + // Salary
                                '</tr>';
                            $('#example tbody').append(row); // Append row to table body
                        });

                        // Initialize the DataTable (ensure you have a function named initializeDataTable)
                        initializeDataTable();
                    },
                    error: function (xhr, status, error) {
                        // Handle error
                        console.error('Error sending date:', error);
                    }
                });
            });
        });


    </script>


     <script>
        function initializeDataTable() {
           $('#example').DataTable({
               dom: 'Bfrtip',
               buttons: ['copy', 'csv', 'excel', 'pdf', 'print']
           });
        }


        $(document).ready(function () {
            initializeDataTable();
        });

        $(document).ready(function () {
            // Set default date to today
            var today = new Date().toISOString().split('T')[0];
            $('#selectedDate').val(today);

            // Trigger change event to make AJAX request for the default date
            $('#selectedDate').change();
        });
            // Attach change event handler to the date input field
            $('#selectedDate').change(function () {
                // Get the value of the input field
                var selectedDate = $(this).val();

                // Make AJAX request to the controller
                $.ajax({
                url: '/Admin/EmpPayrollbyDate',
                    type: 'Get',
                    data: { date: selectedDate },
                    success: function (response) {
                        console.log(response);
                    if ($.fn.DataTable.isDataTable('#example')) {
                        $('#example').DataTable().destroy();
                    }
                        $('#examplet').empty(); // Clear the table body
                        response.salaries.forEach(function (item, index) {
                            var row = '<tr>' +
                                '<td>' + (index + 1) + '</td>' + // Serial Number
                                '<td>' + item.name + '</td>' + // Name
                            '<td>' + item.empType + '</td>' + // ComOrder
                            '<td>' + item.id + '</td>' + // Salary
                            '<td>' + item.deptName + '</td>' + // Pf No
                            '<td>' + item.accountNo + '</td>' + // Pf No
                            '<td>' + item.comOrder + '</td>' + // Pf No
                            '<td>' + item.salary + '</td>' + // Account No
                              
                                '</tr>';
                            $('#examplet').append(row); // Append row to table body


                        });
                    initializeDataTable();
                    },
                    error: function (xhr, status, error) {
                        // Handle error
                        console.error('Error sending date:', error);
                    }
                });
            });
  
        // function generate() {
        //     var date1 = $('#selectedDate1').val();
        //     var date2 = $('#selectedDate2').val();

        //     // First AJAX call for Statusinfo   EmpPayrollbyDateRange
        //     $.ajax({
        //         url: '/Admin/EmpPayrollbyDateRange',
        //         type: 'POST',
        //         data: {
        //             dateA: date1,
        //             dateB: date2
        //         },
        //         dataType: "json",
        //         success: function (responce) {
        //             console.log(responce.data);

        //           //  alert("ok");
        //             if ($.fn.DataTable.isDataTable('#example')) {
        //                 $('#example').DataTable().destroy();
        //             }
                    

        //             $('#examplet').empty(); // Clear the table body
        //             responce.salaries.forEach(function (item, index) {
        //                 var row = '<tr>' +
        //                     '<td>' + (index + 1) + '</td>' + // Serial Number
        //                     '<td>' + item.name + '</td>' + // Name
        //                     '<td>' + item.empType + '</td>' + // ComOrder
        //                     '<td>' + item.id + '</td>' + // Salary
        //                     '<td>' + item.deptName + '</td>' + // Pf No
        //                     '<td>' + item.accountNo + '</td>' + // Pf No
        //                     '<td>' + item.comOrder + '</td>' + // Pf No
        //                     '<td>' + item.salary + '</td>' + // Account No
        //                     '</tr>';
        //                 $('#examplet').append(row); // Append row to table body
        //             });

        //             initializeDataTable();
        //         },
        //         error: function () {
        //             // Handle error
        //             console.error('Error sending date:');
        //         }
        //     });
        // }

         
    </script>


  
</body>
