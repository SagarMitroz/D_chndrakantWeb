@model IEnumerable<D_Chandrakant.Models.CustemorWiseViewModel>
@{
    Layout = "_Layout";
   // Layout = null;
    var sr = 1;
}



<head>
    <meta name="viewport" content="width=device-width" />
    <title>Customer</title>

  


  
  
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Public+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap"
          rel="stylesheet" />
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <link href="https://cdn.datatables.net/1.10.12/css/jquery.dataTables.css" rel="stylesheet" />
    <link href="https://cdn.datatables.net/buttons/1.2.2/css/buttons.dataTables.css" rel="stylesheet" />
    <link rel="shortcut icon" type="image/png" class="bg-black" href="../assets/images/logos/Favicon.png" />
    <link rel="stylesheet" href="../assets/css/styles.min.css" />
    <link rel="stylesheet" href="../assets/css/bootstrap.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <script src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    @* <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.bundle.min.js"></script> *@
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>
    <script src="https://code.jquery.com/ui/1.13.0/jquery-ui.js"></script>
    <script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.js"></script>
    <script src="https://cdn.datatables.net/1.10.16/js/jquery.dataTables.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.32/pdfmake.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.32/vfs_fonts.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.4.2/js/dataTables.buttons.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.4.2/js/buttons.html5.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.2.1/js/buttons.print.min.js"></script>
   @*  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.3/jquery.validate.min.js"></script> *@




    <script src="~/assets/libs/bootstrap/dist/js/bootstrap.bundle.min.js"></script>

    <style>
        tbody, td, tfoot, th, thead, tr {
            border-color: #e9e9e9 !important;
        }

        table.dataTable.no-footer {
            border-color: #e9e9e9 !important;
        }

        .headerrow {
            background: #dae1e5;
            height: 60px;
            vertical-align: middle;
        }

        .center-buttons {
            display: flex;
            justify-content: center;
        }

        .dataTables_wrapper .dataTables_filter input {
            margin-left: 0.5em;
            border-radius: 20px;
            height: 35px;
            outline-offset: 0px;
            padding: 10px;
            border: 2px solid #bdbdbd;
        }


        .dataTables_wrapper .dataTables_paginate .paginate_button.current, .dataTables_wrapper .dataTables_paginate .paginate_button.current:hover {
            color: #333 !important;
            border-radius: 20px;
            border: 0px solid #979797;
            background: #ffe1e1;
        }

        table.dataTable tbody th, table.dataTable tbody td {
            padding: 15px 10px;
        }

        .menu-submenu {
            transition: max-height 0.3s ease-in-out;
            max-height: 0;
            overflow: hidden;
        }

            .menu-submenu.show {
                max-height: 500px; /* Adjust as needed */
            }

        .pagination {
            justify-content: center;
        }

        .profile-link {
            cursor: pointer;
        }

        /* Custom styles for autocomplete dropdown */
        .ui-autocomplete {
            max-height: 200px;
            overflow-y: auto;
            overflow-x: hidden;
            padding-right: 20px;
            border: 1px solid #ccc;
            background-color: #fff;
            z-index: 1000 !important;
            font-size: 14px;
            white-space: nowrap; /* Prevent wrapping */
        }

            .ui-autocomplete li {
                list-style-type: none;
                padding: 5px 10px;
                cursor: pointer;
                white-space: nowrap; /* Force one line */
                overflow-x: auto; /* Allow horizontal scroll if text is too long */
                max-width: 400px; /* Set width limit */
            }

                /* Hover effect fix: white text on blue background */
                .ui-autocomplete li:hover {
                    background-color: #007bff;
                    color: #fff;
                }

        /* jQuery UI selected item style */
        .ui-state-active {
            background-color: #007bff !important;
            color: #fff !important;
        }

        /* Hide screen-reader accessible helper */
        .ui-helper-hidden-accessible {
            display: none;
        }

        /* Optional: visible scrollbar on long names */
        .ui-autocomplete li::-webkit-scrollbar {
            height: 4px;
        }

        .ui-autocomplete li::-webkit-scrollbar-thumb {
            background: #ccc;
            border-radius: 2px;
        }
    </style>
</head>

<body class="bg-light-primary">








    <section class="Emp-management mb-4">
        <header class="container-fluid">
            <div class="row">
                @* <div class="col-md-3 mt-2 mb-2">
                    <form id="monthlyReportForm">
                        <div class="form-group">
                            <label for="selectedDate1">Start Date:</label>
                            <input type="date" id="selectedDate1" name="selectedDate1" class="form-control">
                        </div>
                    </form>
                </div>

                <div class="col-md-3 mt-2 mb-2">
                    <div class="form-group">
                        <label for="selectedDate2">End Date:</label>
                        <input type="date" id="selectedDate2" name="selectedDate2" class="form-control">
                    </div>
                </div>
                 <div class="col-md-3 mt-2 mb-2">
                    <div class="form-group">
                        <label for="selectedDate2">Filter</label>
                        <input id="supplier" name="supplier" type="text" class="w-full text-sm border-slate-200 shadow-sm rounded-md" />

                    </div>
                </div>

                <div class="col-3 mt-2 mb-2" ">
                    <div class="form-group">
                        <button class="btn  border-primary rounded-pill bg-primary text-white w-30 " style="margin-top: 34px;" type="button" onclick="generate()">Get Report</button>

                    </div>
                </div> *@


                <div class="col-9 mt-2 mb-2" style="display:flex;">
                    <div class="col-3" id="reportrange" style="background: #fff; cursor: pointer; padding: 5px 10px; border: 1px solid #ccc; width: ;">
                        <i class="bi bi-calendar3"></i>&nbsp;
                        <span id="dggf"></span> <i class="fa fa-caret-down"></i>
                    </div>
                    <div class="col-3">


                        <input id="supplier" name="supplier" placeholder="Select Employee"  type="text" class="w-full text-sm border-slate-200 shadow-sm rounded-md" />
                    </div>


                    <div class="col-2">

                        <button id="searchButton" type="submit" class="btn btn-primary" style="margin-top: -1px;">Search</button>
                    </div>


                    @*  Select date
                    <input type="date" id="selectedDate" /> *@
                </div>



            </div>


        </header>

    </section>




    <section class="section-table">
        <section class="container-fluid">
                    @*  <div class="row"> *@
                    @* <div class="card  w-100" "> *@
                    @*  <div class="card w-100"> *@
            <div id="tab2Content" class="tab-content mt-4">
                <div class="card" style="padding: 30px;box-shadow:0 7px 10px 10px rgb(7 38 72 / 12%);">
                    <table class="table" id="example" style="text-align:center;">
                        <thead>
                            <tr style="background-color: #E1E2FF;">
                                <th style="display:none;">Count</th>
                                <th>Employee Id</th>
                                <th>Employee Name</th>
                                <th>Employee Department</th>
                                <th>Customer Name</th>
                                <th>Memo No</th>
                                <th>Qty</th>
                                <th>Rate</th>
                                <th>Total</th>
                                

                            </tr>
                        </thead>
                        <tbody id="examplet">
                                <tr>
                                    <td style="display:none"></td>
                                    <td></td>
                                <td></td>
                                 <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                </tr>
                        </tbody>
                    </table>
                </div>

                        @*  </div> *@
                        @*  </div> *@
                        @*  </div> *@


        </section>
    </section>



    </div>
    </main>
    </div>



  
        <script>
            $(document).ready(function () {

                var start = moment().subtract(29, 'days');
                var end = moment();

                function cb(start, end) {
                    $('#reportrange span').html(start.format(' DD/MM/YYYY') + ' - ' + end.format(' DD/MM/YYYY'));
                }

                $('#reportrange').daterangepicker({

                    startDate: start,
                    endDate: end,
                    ranges: {
                        'Today': [moment(), moment()],
                        'Yesterday': [moment().subtract(1, 'days'), moment().subtract(1, 'days')],
                        'Last 7 Days': [moment().subtract(6, 'days'), moment()],
                        'Last 30 Days': [moment().subtract(29, 'days'), moment()],
                        'This Month': [moment().startOf('month'), moment().endOf('month')],
                        'Last Month': [moment().subtract(1, 'month').startOf('month'), moment().subtract(1, 'month').endOf('month')]
                    }
                }, cb);

                cb(start, end);

            });
    </script>



    <script>
        function initializeDataTable() {
            $('#example').DataTable({
                dom: 'Bfrtip',
                "pageLength": 50,
                buttons: [
                    'excel', // Keep existing buttons

                    {
                        extend: 'print',
                        text: 'Print',
                        customize: function (win) {
                            // Hide the first column from print output
                            $(win.document.body).find('table').each(function () {
                                $(this).find('th:first-child, td:first-child').hide();
                            });
                        }
                    }
                ]

            });

        }





        $(document).ready(function () {
            $("#searchButton").click(function () {
                // Retrieve selected date range
                var dateRange = $("#dggf").text().trim();

                // Split the date range into start and end dates
                var dates = dateRange.split("-");
                if (dates.length !== 2) {
                    console.error('Invalid date range format');
                    return;
                }
                var startDate = dates[0].trim();
                var endDate = dates[1].trim();

                // Gather other data from form elements
                var supplier = $("#supplier").val();

                // Log the data being sent for debugging
                console.log({
                    startDate: startDate,
                    endDate: endDate,
                    supplier: supplier
                });

                // AJAX call
                $.ajax({
                    type: "POST",
                    url: '/Admin/CustomerwiseRecJ',
                    data: {
                        startDate: startDate,
                        endDate: endDate,
                        supplier: supplier
                    },
                    success: function (response) {
                        console.log(response);

                        if ($.fn.DataTable.isDataTable('#example')) {
                            $('#example').DataTable().destroy();
                        }

                        // Clear the table body
                        $('#examplet').empty();
                        var ct = 0;
                        response.forEach(function (emp) {
                            var row = '<tr>' +
                                '<td style="display:none;">' + ct + '</td>' +
                                '<td>' + emp.empId + '</td>' +
                                '<td>' + emp.empName + '</td>' +
                                '<td>' + emp.empDept + '</td>' +
                                '<td></td>' +
                                '<td></td>' +
                                '<td></td>' +
                                '<td></td>' +
                                '<td></td>' +
                                '</tr>';
                            $('#examplet').append(row); // Append row to table body

                            if (emp.itemlists && emp.itemlists.length > 0) {
                                emp.itemlists.forEach(function (item) {
                                    var itemRow = '<tr>' +
                                        '<td style="display:none;">' + ct + '</td>' +
                                        '<td></td>' +
                                        '<td></td>' + // Empty cell for employee name
                                        '<td></td>' +
                                        '<td>' + item.cName + '</td>' +
                                        '<td>' + item.memoNo + '</td>' +
                                        '<td>' + item.comOrder + '</td>' +
                                        '<td>' + item.rate + '</td>' +
                                        '<td>' + item.total + '</td>' +
                                        '</tr>';
                                    $('#examplet').append(itemRow); // Append itemRow to table body
                                });

                                var summaryRow = '<tr>' +
                                    '<td style="display:none;">' + ct + '</td>' + // Empty cell for employee name
                                    '<td></td>' + // Empty cell for employee name
                                    '<td></td>' +
                                    '<td></td>' +
                                    '<td></td>' +
                                    '<td></td>' +
                                    '<td>' + emp.tComOrder + '</td>' +
                                    '<td></td>' +
                                    '<td>' + emp.totalS + '</td>' +
                                    '</tr>';
                                $('#examplet').append(summaryRow); // Append summaryRow to table body
                            }
                        });

                        initializeDataTable(); // Initialize the DataTable
                    },
                    error: function (xhr, status, error) {
                        // Handle error
                        console.error('Error sending data:', error);
                    }
                });
            });
        });





        // $("#searchButton").click(function () {
        //     // Retrieve selected date range
        //     var dateRange = $("#dggf").text().trim();

        //     // Split the date range into start and end dates
        //     var dates = dateRange.split("-");
        //     if (dates.length !== 2) {
        //         console.error('Invalid date range format');
        //         return;
        //     }
        //     var startDate = dates[0].trim();
        //     var endDate = dates[1].trim();
          
        //     // Gather other data from form elements
        //     var supplier = $("#supplier").val();

        //     // Log the data being sent for debugging
        //     // console.log({
        //     //     startDate: startDate,
        //     //     endDate: endDate,
        //     //     supplier: supplier
        //     // });

        //     // AJAX call
        //     $.ajax({
        //         type: "POST",
        //         url: '/Admin/CustomerwiseRecJ',
        //         data: {
        //             startDate: startDate,
        //             endDate: endDate,
        //             supplier: supplier
        //         },
        //     });
        // });


    </script>



   
    // <script>
        
      

    //     //     initializeDataTable();
    //     // });

    //     // // Attach change event handler to the date input field
    //     // // Attach change event handler to the date input field

    //     // // $(document).ready(function () {
    //     // //     // Set default date to today
    //     // //     var today = new Date().toISOString().split('T')[0];
    //     //     $('#selectedDate').val(today);

    //     //     // Trigger change event to make AJAX request for the default date
    //     //     $('#selectedDate').change();
    //     // });

    //     // $('#selectedDate').change(function () {
    //     //     // Get the value of the input field
    //     //     var selectedDate = $(this).val();

    //     //     // Make AJAX request to the controller
    //     //     $.ajax({
    //     //         url: '/Admin/CustomerwiseRecByDate',
    //     //         type: 'Get',
    //     //         data: { date: selectedDate },
    //     //         success: function (response) {
    //     //             console.log(response);
                  
    //     //             if ($.fn.DataTable.isDataTable('#example')) {
    //     //                 $('#example').DataTable().destroy();
    //     //             }
    //     //             // Clear the table body
    //     //             $('#examplet').empty();
    //     //             var ct = 0;
    //     //             response.forEach(function (emp) {

    //     //                 //ct = ct + 1;

    //     //                 var row = '<tr>' +
    //     //                     '<td style="display:none;">' + ct + '</td>' +
    //     //                     '<td>' + emp.empId + '</td>' +
    //     //                     '<td>' + emp.empName + '</td>' +
    //     //                     '<td>' + emp.empDept + '</td>' +
    //     //                     '<td></td>' +
    //     //                     '<td></td>' +
    //     //                     '<td></td>' +
    //     //                     '<td></td>' +
    //     //                     '<td></td>' +
    //     //                     '</tr>';
    //     //                 $('#examplet').append(row); // Append row to table body

    //     //                 if (emp.itemlists && emp.itemlists.length > 0) {
    //     //                     emp.itemlists.forEach(function (item) {
    //     //                         var itemRow = '<tr>' +
    //     //                             '<td style="display:none;">' + ct + '</td>' +
    //     //                             '<td></td>' +
    //     //                             '<td></td>' + // Empty cell for employee name
    //     //                             '<td></td>' +
    //     //                             '<td>' + item.cName + '</td>' +
    //     //                             '<td>' + item.memoNo + '</td>' +
    //     //                             '<td>' + item.comOrder + '</td>' +
    //     //                             '<td>' + item.rate + '</td>' +
    //     //                             '<td>' + item.total + '</td>' +
    //     //                             '</tr>';
    //     //                         $('#examplet').append(itemRow); // Append itemRow to table body
    //     //                     });

    //     //                     var summaryRow = '<tr>' +
    //     //                         '<td style="display:none;">' + ct + '</td>' + // Empty cell for employee name
    //     //                         '<td></td>' + // Empty cell for employee name
    //     //                         '<td></td>' +
    //     //                         '<td></td>' +
    //     //                         '<td></td>' +
    //     //                         '<td></td>' +
    //     //                         '<td>' + emp.tComOrder + '</td>' +
    //     //                         '<td></td>' +
    //     //                         '<td>' + emp.totalS + '</td>' +
    //     //                         '</tr>';
    //     //                     $('#examplet').append(summaryRow); // Append summaryRow to table body
    //     //                 }
    //     //             });

    //     //             initializeDataTable(); // Initialize the DataTable
    //     //         },
    //     //         error: function (xhr, status, error) {
    //     //             // Handle error
    //     //             console.error('Error sending date:', error);
    //     //         }
    //     //     });
    //     // });


    //     // function generate() {
    //     //     var date1 = $('#selectedDate1').val();
    //     //     var date2 = $('#selectedDate2').val();
    //     //     var data3 = $('#supplier').val();
    //     //     alert(data3);
    //     //     // First AJAX call for Statusinfo   EmpPayrollbyDateRange
    //     //     $.ajax({
    //     //         url: '/Admin/CustomerwiseRecByDateRAnge',
    //     //         type: 'POST',
    //     //         data: {
    //     //             dateA: date1,
    //     //             dateB: date2,
    //     //             EN: data3,
    //     //         },
    //     //         dataType: "json",
    //     //         success: function (data) {
    //     //             console.log(data);
                

    //     //             if ($.fn.DataTable.isDataTable('#example')) {
    //     //                 $('#example').DataTable().destroy();
    //     //             }

    //     //             $('#examplet').empty(); // Clear the table body

    //     //             var ct = 0;


    //     //             data.forEach(function (emp) {
    //     //                 ct = ct + 1;

    //     //                 var row = '<tr>' +
    //     //                     '<td style="display:none;">' + ct + '</td>' +
    //     //                     '<td>' + emp.empId + '</td>' +
    //     //                     '<td>' + emp.empName + '</td>' +
    //     //                     '<td>' + emp.empDept + '</td>' +
    //     //                     '<td></td>' +
    //     //                     '<td></td>' +
    //     //                     '<td></td>' +
    //     //                     '<td></td>' +
    //     //                     '<td></td>' +
    //     //                     '</tr>';
    //     //                 $('#examplet').append(row); // Append row to table body

    //     //                 if (emp.itemlists && emp.itemlists.length > 0) {
    //     //                     emp.itemlists.forEach(function (item) {
    //     //                         var itemRow = '<tr>' +
    //     //                             '<td style="display:none;">' + ct + '</td>' +
    //     //                             '<td></td>' +
    //     //                             '<td></td>' +
    //     //                             '<td></td>' +
    //     //                             '<td>' + item.cName + '</td>' +
    //     //                             '<td>' + item.memoNo + '</td>' +
    //     //                             '<td>' + item.comOrder + '</td>' +        
    //     //                             '<td>' + item.rate + '</td>' +
    //     //                             '<td>' + item.total + '</td>' +
    //     //                             '</tr>';
    //     //                         $('#examplet').append(itemRow); // Append itemRow to table body
    //     //                     });

    //     //                         var itemRow = '<tr>' +
    //     //                         '<td style="display:none;">' + ct + '</td>' +
    //     //                         '<td></td>' +
    //     //                         '<td></td>' +
    //     //                         '<td></td>' +
    //     //                             '<td></td>' +
    //     //                             '<td></td>' +
    //     //                             '<td>' + emp.tComOrder + '</td>' +
    //     //                             '<td></td>' +
    //     //                         '<td>' + emp.totalS + '</td>' +

    //     //                             '</tr>';
    //     //                         $('#examplet').append(itemRow);
                            
    //     //                 }
    //     //             });

    //     //             initializeDataTable(); //Initialize the DataTable
    //     //         },
    //     //         error: function () {
    //     //             // Handle error
    //     //             console.error('Error sending date:');
    //     //         }
    //     //     });
    //     // }


    // </script>


    

        
        <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
     
        <script>
            jQuery(function () {
                jQuery("#supplier").autocomplete({
                    source: function (request, response) {
                        jQuery.ajax({
                            url: "/Admin/GetSupplierbyname",
                            dataType: "json",
                            data: { term: request.term },
                            success: function (data) {
                                response($.map(data, function (item) {
                                    return {
                                        label: item.label,
                                        value: item.label,
                                        id: item.id
                                    };
                                }));
                            },
                            error: function (jqXHR, textStatus, errorThrown) {
                                console.error('Error fetching data: ' + textStatus, errorThrown);
                            }
                        });
                    },
                    minLength: 2,
                    select: function (event, ui) {
                        var Name = ui.item.label;
                        var Id = ui.item.id;
                        $("#Id").val(Id);

                        var newid = $("#Id").val();
                        // alert(newid);
                        // console.log("Selected Product: ", Name, " (ID: ", Id, ")");
                    },
                    open: function (event, ui) {
                        $(this).autocomplete("widget").position({
                            my: "left top",
                            at: "left bottom",
                            of: this
                        });
                       $(this).autocomplete("widget").outerWidth($(this).outerWidth());
                    }
                });
            });
        </script>
    






</body>


