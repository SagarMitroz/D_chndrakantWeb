@model D_Chandrakant.Models.EmpSalViewModel
@{

    Layout = null;
    var sr = 1;
}

<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>D.Chandrakant Tailors </title>
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
    <link rel="shortcut icon" type="image/png" class="bg-black" href="../assets/images/logos/Favicon.png" />
    <link rel="stylesheet" href="../assets/css/styles.min.css" />
    <link rel="stylesheet" href="../assets/css/bootstrap.css" />
    <link rel="stylesheet" href="../assets/css/bootstrap.css">
    <link rel="stylesheet" href="/css/Datatable.css" />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Public+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap"
          rel="stylesheet" />


    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

    <link href="https://cdn.datatables.net/1.10.12/css/jquery.dataTables.css" rel="stylesheet" />
    <link href="https://cdn.datatables.net/buttons/1.2.2/css/buttons.dataTables.css" rel="stylesheet" />
    <style>
        tbody, td, tfoot, th, thead, tr {
            border-color: #e9e9e9 !important;
        }

        table.dataTable.no-footer {
            border-color: #e9e9e9 !important;
        }

        .headerrow {
            background: #dae1e5;
            height: 60px;
            vertical-align: middle;
        }

        .center-buttons {
            display: flex;
            justify-content: center;
        }

        .dataTables_wrapper .dataTables_filter input {
            margin-left: 0.5em;
            border-radius: 20px;
            height: 35px;
            outline-offset: 0px;
            padding: 10px;
            border: 2px solid #bdbdbd;
        }


        .dataTables_wrapper .dataTables_paginate .paginate_button.current, .dataTables_wrapper .dataTables_paginate .paginate_button.current:hover {
            color: #333 !important;
            border-radius: 20px;
            border: 0px solid #979797;
            background: #ffe1e1;
        }

        table.dataTable tbody th, table.dataTable tbody td {
            padding: 15px 10px;
        }

        .menu-submenu {
            transition: max-height 0.3s ease-in-out;
            max-height: 0;
            overflow: hidden;
        }

            .menu-submenu.show {
                max-height: 500px; /* Adjust as needed */
            }

        .pagination {
            justify-content: center;
        }

        .profile-link {
            cursor: pointer;
        }
    </style>
</head>

<body class="bg-light-primary">


    <section class="sticky-lg-top">
        <nav class="navbar navbar-expand-lg navbar-light bg-white  rounded">
            <div class="container-fluid">
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
                        aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse ml-2" id="navbarSupportedContent">
                    <ul class="navbar-nav  mb-lg-0 ">
                        @*  <li class="nav nav-item fs-4  ">
                        <img src="../assets/images/images/home.png" width="20px" height="20px" class="mt-2">
                        <a class="nav-link thumbnail active text-primary  " asp-action="DashBoard">Dashboard</a>
                        </li> *@
                        <li class="nav nav-item fs-4 ml-2">
                            <img src="../assets/images/images/admin-alt.png" width="20px" height="20px" class="mt-2">
                            <a class="nav-link  thumbnail  " aria-current="page" asp-action="EmployeeManagement">
                                Employees
                                Management
                            </a>
                        </li>

                        <img src="../assets/images/images/search1.png" width="20px" height="20px" class="mt-2">
                        <li class="nav-item dropdown fs-4 ">

                            @*   <a class="nav-link " aria-current="page" asp-action="TrackStatus">Tracking Status</a> *@
                            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown"
                               aria-expanded="false">
                                Tracking Status
                            </a>
                            <ul class="dropdown-menu " aria-labelledby="navbarDropdown">
                                <li><a class="dropdown-item hover-dd " asp-action="TrackStatus">By Memo No</a></li>
                                <li><a class="dropdown-item" asp-action="TrackStatusbyMeasure">By Measurment No</a></li>

                            </ul>
                        </li>
                        <img src="../assets/images/images/calendar (1).png" width="20px" height="20px" class="mt-2">
                        <li class="nav-item dropdown fs-4  ">

                            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown"
                               aria-expanded="false">
                                Payroll
                            </a>
                            <ul class="dropdown-menu " aria-labelledby="navbarDropdown">
                                <li><a class="dropdown-item hover-dd " asp-action="EmpPayroll">Employee Payroll</a></li>
                                <li><a class="dropdown-item" asp-action="EmpPayrollSet">Payroll Setting</a></li>

                            </ul>
                        </li>

                        <li class="nav-item dropdown fs-4  ">

                            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown"
                               aria-expanded="false">
                                Report
                            </a>
                            <ul class="dropdown-menu " aria-labelledby="navbarDropdown">
                                <li><a class="dropdown-item hover-dd " asp-action="EmpPayroll">Pay on work Employee Report</a></li>
                                <li><a class="dropdown-item hover-dd " asp-action="EmpPayrollPerm">Permanent Employee Report</a></li>
                                <li><a class="dropdown-item" asp-action="CustomerwiseRec">CustomerWise Report</a></li>
                                <li><a class="dropdown-item" asp-action="GetMonthlyReport">Monthly Bill Report</a></li>
                            </ul>
                        </li>
                        <li class="nav nav-item fs-4 ml-2">
                            @* <img src="../assets/images/images/admin-alt.png" width="20px" height="20px" class="mt-2"> *@
                            <a class="nav-link  thumbnail  " aria-current="page" asp-action="EmployeeSalary">
                                Salary Management
                            </a>
                        </li>


                        <li class="nav nav-item fs-4 ml-5 disabled " hidden style="margin-left: 100;">
                            <a class="nav-link " aria-current="page" href="#">D.Chandrakant Tailors </a>
                        </li>


                    </ul>
                </div>
                <div class="navbar-collapse ml-5 " id="navbarNav" style="display: flex; justify-content: flex-end;">

                    <li class="nav nav-item fs-4 disabled" style="padding-left: 150px;" ;">
                        <a class="nav-link active text-dark" aria-current="page" href="#" id="date"> </a>
                    </li>

                    <ul class="navbar-nav flex-row ms-auto pb-3">
                        <li class="nav-item dropdown d-flex">
                            <a class="nav-link nav-icon-hover" href="javascript:void(0)" id="drop2" data-bs-toggle="dropdown"
                               aria-expanded="false">
                                <img src="../assets/images/profile/user-1.jpg" alt="" width="35" height="35"
                                     class="rounded-circle mr-3 mt-2">
                            </a>
                            <a asp-action="AdminLogin" asp-controller="AuthAd" class="btn btn-danger rounded-pill w-75 mt-3 "
                               style=" width: 250px;"> Logout</a>

                            @*    <div class="dropdown-menu dropdown-menu-end dropdown-menu-animate-up" aria-labelledby="drop2">
                            <div class="message-body">
                            <a href="javascript:void(0)" class="d-flex align-items-center gap-2 dropdown-item">
                            <i class="ti ti-user fs-6"></i>
                            <p class="mb-0 fs-3">My Profile</p>
                            </a>
                            <a href="javascript:void(0)" class="d-flex align-items-center gap-2 dropdown-item">
                            <i class="ti ti-mail fs-6"></i>
                            <p class="mb-0 fs-3">My Account</p>
                            </a>
                            <a href="javascript:void(0)" class="d-flex align-items-center gap-2 dropdown-item">
                            <i class="ti ti-list-check fs-6"></i>
                            <p class="mb-0 fs-3">My Task</p>
                            </a>
                            </div>

                            </div> *@
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
    </section>

    <div class="container-fluid">
        <main role="main" class="pb-3">

            <section class="Emp-management mb-4">
                <header class="container-fluid">
                    <div class="row">
                        <div class="col-3">
                            <h2 class="ml-2">Permanent Payroll</h2>
                        </div>
                        <div class="col-3 mt-2 mb-2" ">
                        @*  <button class=" btn border-primary rounded-pill bg-white text-primary  " style="width: 150px;">
                            Select Date
                            <img src="../assets/images/images/calendar.png" width="20px" class="">
                            <input type="date" name="name" value="Select Date" />

                            </button> *@
                            Select date
                            <input type="date" id="selectedDate" />
                        </div>
                        @*  <div class="col-6 mt-2 mb-2">
                        <div style="display: flex; justify-content: flex-end;">
                        <div class="dropdown">
                        <div class="mr-2" style="display: flex; justify-content: flex-end;">
                        <form class="d-flex ">
                        Start Date:
                        <input type="date" id="selectedDate1" /> To
                        End Date:
                        <input type="date" id="selectedDate2" />
                        <button onclick="generate()" class="btn  border-primary rounded-pill bg-primary text-white w-30 "
                        type="button">
                        Generate
                        </button>
                        </form>
                        </div>
                        </div>
                        </div>
                        </div> *@
                    </div>


    </div>
    </header>
    </div>
    </div>
    </section>






    <section class="Emp-management mb-4">
        <header class="container-fluid">
            <div class="row">
                <div class="col-md-3 mt-2 mb-2">
                    <form id="monthlyReportForm">
                        <div class="form-group">
                            <label for="selectedDate1">Start Date:</label>
                            <input type="date" id="selectedDate1" name="selectedDate1" class="form-control">
                        </div>
                    </form>
                </div>

                <div class="col-md-3 mt-2 mb-2">
                    <div class="form-group">
                        <label for="selectedDate2">End Date:</label>
                        <input type="date" id="selectedDate2" name="selectedDate2" class="form-control">
                    </div>
                </div>

                <div class="col-3 mt-2 mb-2" ">
                    <div class="form-group">
                        <button class="btn  border-primary rounded-pill bg-primary text-white w-30 " style="margin-top: 34px;" type="button" onclick="generate()">Get Report</button>

                    </div>
                </div>



            </div>


        </header>

    </section>




    <section class="section-table">
        <section class="container-fluid">
                    @*  <div class="row"> *@
                    @* <div class="card  w-100" "> *@
                    @*  <div class="card w-100"> *@
            <div id="tab2Content" class="tab-content mt-4">
                <div class="card" style="padding: 30px;box-shadow:0 7px 10px 10px rgb(7 38 72 / 12%);">
                    <table class="table" id="example" style="text-align:center;">
                        <thead>
                            <tr style="background-color: #E1E2FF;">
                                <th>Sr No</th>
                                <th>Name</th>

                                <th>Employee Type</th>
                                <th>ID No</th>
                                <th>Department</th>
                                <th>Account No</th>
                                <th>Qty</th>
                                <th>Salary</th>

                            </tr>
                        </thead>
                        <tbody id="examplet">
                                    @if (Model.salaries.Count > 0)
                                    {
                                        @foreach (var item in Model.salaries)
                                        {
                                    <tr>
                                        <td>@sr</td>
                                        <td>@item.Name</td>
                                        <td>@item.EmpType</td>
                                        <td>@item.Id</td>
                                        <td>@item.DeptName</td>
                                        <td>@item.AccountNo</td>
                                        <td>@item.ComOrder</td>
                                        <td>@item.Salary</td>

                                    </tr>
                                            sr++;
                                        }

                                    }
                        </tbody>
                    </table>
                </div>

                        @*  </div> *@
                        @*  </div> *@
                        @*  </div> *@


        </section>
    </section>



    </div>
    </main>
    </div>

    <script src="~/assets/libs/jquery/dist/jquery.min.js"></script>
    <script src="~/assets/libs/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/assets/js/sidebarmenu.js"></script>
    <script src="~/assets/js/app.min.js"></script>
    <script src="~/assets/libs/apexcharts/dist/apexcharts.min.js"></script>
    <script src="~/assets/libs/simplebar/dist/simplebar.js"></script>
    <script src="~/assets/js/dashboard.js"></script>

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://code.jquery.com/ui/1.13.0/jquery-ui.js"></script>
    <script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.js"></script>
    <script src="https://cdn.datatables.net/1.10.16/js/jquery.dataTables.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.32/pdfmake.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.32/vfs_fonts.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.4.2/js/dataTables.buttons.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.4.2/js/buttons.html5.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.2.1/js/buttons.print.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.3/jquery.validate.min.js"></script>



    <script>
        function initializeDataTable() {
            $('#example').DataTable({
                dom: 'Bfrtip',
                buttons: ['copy', 'csv', 'excel', 'pdf', 'print']
            });
        }


        $(document).ready(function () {
            initializeDataTable();
        });

        $(document).ready(function () {
            // Set default date to today
            var today = new Date().toISOString().split('T')[0];
            $('#selectedDate').val(today);

            // Trigger change event to make AJAX request for the default date
            $('#selectedDate').change();
        });
        // Attach change event handler to the date input field
        $('#selectedDate').change(function () {
            // Get the value of the input field
            var selectedDate = $(this).val();

            // Make AJAX request to the controller
            $.ajax({
                url: '/Admin/EmpPayrollbyDatePerm',
                type: 'Get',
                data: { date: selectedDate },
                success: function (response) {
                    console.log(response);
                    if ($.fn.DataTable.isDataTable('#example')) {
                        $('#example').DataTable().destroy();
                    }
                    $('#examplet').empty(); // Clear the table body
                    response.salaries.forEach(function (item, index) {
                        var row = '<tr>' +
                            '<td>' + (index + 1) + '</td>' + // Serial Number
                            '<td>' + item.name + '</td>' + // Name
                            '<td>' + item.empType + '</td>' + // ComOrder
                            '<td>' + item.id + '</td>' + // Salary
                            '<td>' + item.deptName + '</td>' + // Pf No
                            '<td>' + item.accountNo + '</td>' + // Pf No
                            '<td>' + item.comOrder + '</td>' + // Pf No
                            '<td>' + item.salary + '</td>' + // Account No

                            '</tr>';
                        $('#examplet').append(row); // Append row to table body


                    });
                    initializeDataTable();
                },
                error: function (xhr, status, error) {
                    // Handle error
                    console.error('Error sending date:', error);
                }
            });
        });

        function generate() {
            var date1 = $('#selectedDate1').val();
            var date2 = $('#selectedDate2').val();

            // First AJAX call for Statusinfo   EmpPayrollbyDateRange
            $.ajax({
                url: '/Admin/EmpPayrollbyDateRangePerm',
                type: 'POST',
                data: {
                    dateA: date1,
                    dateB: date2
                },
                dataType: "json",
                success: function (responce) {
                    console.log(responce.data);

                    //  alert("ok");
                    if ($.fn.DataTable.isDataTable('#example')) {
                        $('#example').DataTable().destroy();
                    }


                    $('#examplet').empty(); // Clear the table body
                    responce.salaries.forEach(function (item, index) {
                        var row = '<tr>' +
                            '<td>' + (index + 1) + '</td>' + // Serial Number
                            '<td>' + item.name + '</td>' + // Name
                            '<td>' + item.empType + '</td>' + // ComOrder
                            '<td>' + item.id + '</td>' + // Salary
                            '<td>' + item.deptName + '</td>' + // Pf No
                            '<td>' + item.accountNo + '</td>' + // Pf No
                            '<td>' + item.comOrder + '</td>' + // Pf No
                            '<td>' + item.salary + '</td>' + // Account No
                            '</tr>';
                        $('#examplet').append(row); // Append row to table body
                    });

                    initializeDataTable();
                },
                error: function () {
                    // Handle error
                    console.error('Error sending date:');
                }
            });
        }


    </script>











</body>

</html>
