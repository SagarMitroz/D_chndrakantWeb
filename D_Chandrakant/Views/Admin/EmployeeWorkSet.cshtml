@model D_Chandrakant.Models.cardlistviewModelList
@{
     Layout = "_Layout";
    
   
}

<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>D.Chandrakant Tailors </title>
    <link rel="shortcut icon" type="image/png" class="bg-black" href="../assets/images/logos/Favicon.png" />
    <link rel="stylesheet" href="../assets/css/styles.min.css" />
    <link rel="stylesheet" href="../assets/css/bootstrap.css" />
    <link rel="stylesheet" href="../assets/css/bootstrap.css">

    <link rel="stylesheet" href="/css/Datatable.css" />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Public+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap"
          rel="stylesheet" />


    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

    <link href="https://cdn.datatables.net/1.10.12/css/jquery.dataTables.css" rel="stylesheet" />
    <link href="https://cdn.datatables.net/buttons/1.2.2/css/buttons.dataTables.css" rel="stylesheet" />
    <style>
        tbody, td, tfoot, th, thead, tr {
            border-color: #e9e9e9 !important;
        }

        table.dataTable.no-footer {
            border-color: #e9e9e9 !important;
        }

        .headerrow {
            background: #dae1e5;
            height: 60px;
            vertical-align: middle;
        }

        .center-buttons {
            display: flex;
            justify-content: center;
        }

        .dataTables_wrapper .dataTables_filter input {
            margin-left: 0.5em;
            border-radius: 20px;
            height: 35px;
            outline-offset: 0px;
            padding: 10px;
            border: 2px solid #bdbdbd;
        }


        .dataTables_wrapper .dataTables_paginate .paginate_button.current, .dataTables_wrapper .dataTables_paginate .paginate_button.current:hover {
            color: #333 !important;
            border-radius: 20px;
            border: 0px solid #979797;
            background: #ffe1e1;
        }

        table.dataTable tbody th, table.dataTable tbody td {
            padding: 15px 10px;
        }

        .menu-submenu {
            transition: max-height 0.3s ease-in-out;
            max-height: 0;
            overflow: hidden;
        }

            .menu-submenu.show {
                max-height: 500px; /* Adjust as needed */
            }

        .pagination {
            justify-content: center;
        }

        .profile-link {
            cursor: pointer;
        }

        .ui-autocomplete {
            max-height: 200px;
            overflow-y: auto;
            overflow-x: hidden;
            padding-right: 20px; /* Add space for scrollbar */
            border: 1px solid #ccc;
            background-color: #fff;
            z-index: 1000 !important;  
         } 

            .ui-autocomplete li {
                list-style-type: none;
                padding: 5px;
                cursor: pointer;
            }

                .ui-autocomplete li:hover {
                    background-color: #f0f0f0;
                }

        .ui-state-active {
            background-color: #007bff;
            color: #fff;
        }

        #ui-id-1 {
            left: 900px !important;
        }

        .ui-helper-hidden-accessible {
            display: none;
        }

    </style>
</head>

<body class="bg-light-primary">

   





    <section class="Emp-management mb-4">
        <header class="container-fluid">
            <div class="row">
                <div class="col-6">
                    <h2 class="ml-2">Employee Payroll Setting</h2>
                </div>

                <div class="col-6 mt-3">
                   @*  <div class="sec-div mr-2" style="display: flex; justify-content: flex-End;">
                      @*   <a class=" btn border-primary rounded-pill bg-primary text-white  " data-bs-toggle="modal" data-bs-target="#basicModal" style="width: 200px;">
                            Add New Payroll
                        </a> 

                         <span> Select Employee : </span>
                        <input id="supplier" name="supplier" type="text" class="w-full text-sm border-slate-200 shadow-sm rounded-md" /> 

                    </div> *@

                    <div class="form-group">
                        <label for="supplier">Select Employee :</label>
                        <input id="supplier" name="supplier" type="text" class="w-full text-sm border-slate-200 shadow-sm rounded-md" />
                        <button id="filterButton" class="btn btn-primary" type="button" onclick="sendSupplier()">Filter</button>
                    </div>

                </div>

                @*  <div class="col-6 mt-3">
                <div style="display: flex; justify-content: flex-end;">
                <div class="dropdown">
                <div class="mr-2" style="display: flex; justify-content: flex-end;">
                <form class="d-flex ">
                <input class="form-control mr-2 border-primary rounded-pill  text-dark  " type="search" placeholder="Search" aria-label="Search">
                <button class="btn  border-primary rounded-pill bg-primary text-white w-30 "
                type="submit">
                Search
                </button>
                </form>
                </div>
                </div>
                </div>
                </div> *@
            </div>

            <div class="row ">
                @*  <div class="col-6 mt-3">
                <div style="display: flex; justify-content: flex-start;">
                <div class="col-2 ">
                <button class=" btn border-primary rounded-pill bg-white text-primary  " style="width: 100px;">
                Filtter
                <img src="../assets/images/images/filter.png" width="20px" height="20px" class="">
                </button>
                </div>
                <div class="col-3 ">
                <!-- <button class=" btn border-primary rounded-pill bg-white text-primary  " style="width: 150px;">
                Select Date
                <img src="../assets/images/images/calendar.png" width="20px"  class="">

                </button> -->
                <select id="monthSelect" class="btn border-primary rounded-pill bg-white text-primary" style="width: 150px; ">
                <option>Select Month</option>
                <option value="01">January</option>
                <option value="02">February</option>
                <option value="03">March</option>
                <option value="04">April</option>
                <option value="05">May</option>
                <option value="06">June</option>
                <option value="07">July</option>
                <option value="08">August</option>
                <option value="09">September</option>
                <option value="10">October</option>
                <option value="11">November</option>
                <option value="12">December</option>
                </select>

                </div>
                <div class="col-3 ">

                <div class="dropdown">
                <a class="btn  dropdown-toggle border-primary rounded-pill bg-white text-primary" href="#" role="button"
                data-bs-toggle="dropdown" aria-expanded="false">
                Department
                </a>

                <ul class="dropdown-menu">
                <li><a class="dropdown-item" href="#">Cutting</a></li>
                <li><a class="dropdown-item" href="#">Stritching</a></li>
                <li><a class="dropdown-item" href="#">Ironing</a></li>
                <li><a class="dropdown-item" href="#">Delivery</a></li>

                </ul>
                </div>
                </div>
                </div>
                </div> *@
                <div class="col-6 mt-3">
                </div>
            </div>
            </div>
        </header>
        </div>
        </div>
    </section>


    <section class="section-table">
        <section class="container-fluid">
          
            <div id="tab2Content" class="tab-content mt-4">
                <div class="card" style="padding: 30px;box-shadow:0 7px 10px 10px rgb(7 38 72 / 12%);">
                    <table table class="table" id="example" style="text-align:center;">
                        <thead>
                            <tr style="background-color: #E1E2FF;">
                                <th> Sr.No. </th>
                                <th> Item </th>
                                <th> Memo No. </th>
                                <th> Ordered Qty </th>
                                <th> Completed Qty </th>
                                <th> Remove </th>
                            </tr>
                        </thead>
                        <tbody>
                         <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        </tbody>
                    </table>
                </div>
            </div>
            </div>


        </section>
    </section>



    <!--*********** POP UP UPDATE **********-->
  @*   <div class="col-lg-4 col-md-6">
        <div class="mt-3">

            <div class="modal fade" id="editModal" tabindex="-1" aria-labelledby="editModalLabel" aria-hidden="true">
                <div class="modal-dialog modal-xl">
                    <div class="modal-content">
                        <div class="modal-header bg-primary ">
                            <h5 class="modal-title text-white">Update Item Rate</h5>
                            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <div class="container">
                                <div class="row">
                                    <!-- Add your form fields and input elements here for editing -->
                                    <div class="form-group col-6 col-md-6 col-lg-6">
                                        <label for="empId">Product</label>
                                        <input type="text" class="form-control" id="empId" name="empId" readonly>
                                    </div>
                                    <div class="form-group col-6 col-md-6 col-lg-6">
                                        <label for="CR">Cutting</label>
                                        <input type="text" class="form-control" id="CR" name="CR">
                                    </div>
                                    <div class="form-group col-6 col-md-6 col-lg-6">
                                        <label for="SR">Stitching</label>
                                        <input type="text" class="form-control" id="SR" name="SR">
                                    </div>
                                    <div class="form-group col-6 col-md-6 col-lg-6">
                                        <label for="IR">Ironing</label>
                                        <input type="text" class="form-control" id="IR" name="IR">
                                    </div>


                                    <!---->

                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                                        <button type="button" class="btn btn-primary" onclick="saveChanges()">Save Changes</button>
                                    </div>

                                </div>

                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>
 *@

    <!-- *************************************************-->
    <!-- *************  Add New PayRoll***************-->

@* 
    <div class="col-lg-4 col-md-6">
        <div class="mt-3">
            <!-- Modal -->
            <div class="modal  bg-transparent" id="basicModal" tabindex="-1" aria-hidden="true">
                <div class="modal-dialog modal-xl">
                    <div class="modal-content">
                        <form asp-action="AddItemRate" asp-controller="Admin" method="post">

                            <div class="modal-header bg-primary ">
                                <h5 class="modal-title text-white">Add Item Rate</h5>
                                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                            </div>
                            <div class="modal-body">
                                <div class="container">
                                    <div class="row">
                                        <div class="form-group col-6 col-md-6 col-lg-6">
                                            <label asp-for="ItemId" for="Itemfk">Product</label>
                                            <select asp-for="ItemId" name="ItemId" id="Itemfk" class="form-control">
                                                <option selected disabled>Select Product</option>
                                            </select>
                                        </div>

                                        <div class="form-group col-6 col-md-6 col-lg-6">
                                            <label asp-for="CuttingR" for="CuttingR">Cutting</label>
                                            <input asp-for="CuttingR" type="text" name="CuttingR" class="form-control" required>
                                        </div>
                                        <div class="form-group col-6 col-md-6 col-lg-6">
                                            <label asp-for="StretchingR" for="StretchingR">Stitching</label>
                                            <input asp-for="StretchingR" type="text" name="StretchingR" class="form-control" required>
                                        </div>

                                        <div class="form-group col-6 col-md-6 col-lg-6">
                                            <label asp-for="IorningR" for="IorningR">Ironing</label>
                                            <input asp-for="IorningR" type="text" name="IorningR" class="form-control" required>
                                        </div>



                                        <div class="form-group col-12 col-md-6 col-lg-6">

                                            <button type="submit" class="btn btn-primary" style="margin-top:6%; width:10rem;border-radius:20px">Save</button>
                                        </div>

                                    </div>
                                </div>
                            </div>

                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div> *@


    <!-- *************************************************-->
    @* ****************************** Delete Alert ******************************** *@
    <!-- Delete Modal -->
    <div class="modal fade" id="deleteModal" tabindex="-1" role="dialog" aria-labelledby="deleteModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header mx-auto">
                    <h5 class="modal-title text-danger  mx-auto " id="deleteModalLabel"><strong>रद्द करा  </strong>    </h5>
                    @*  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                    </button> *@
                </div>
                <div class="modal-body mx-auto">
                    रेकॉर्ड काढून टाका.
                </div>
                <div class="modal-footer mx-auto">
                    <button type="button" class="btn btn-secondary" onclick="hideopenmodel();">Cancel</button>
                    <button type="button" class="btn btn-danger" onclick="deleteEmployee()">Delete</button>
                </div>
            </div>
        </div>
    </div>

    @* ************************************************************************* *@

    @* ***************************** Modal after delete ******************************************* *@
    <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content" style="    border-radius: 0.5rem !important;">
                <div class="modal-header" style="    align-items: center;
    display: flex;
    flex-direction:column;">
                    <h5 class="modal-title" id="exampleModalLabel" style="margin: -11px;"> Barcode Id</h5>
                    <hr class="new5" id="underline">

                </div>
                <div class="modal-body">
                    <center><p id="alertmsg"></p></center>
                </div>


                <center>
                    <button type="button" class="btn btn-primary" onclick="closepopupmodel();" style="margin-bottom: 11px;
                     border-radius: 19px;    width: 145px;">
                        Okay
                    </button>
                </center>

            </div>
        </div>
    </div>


    <!--*******************************************-->

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>


    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.bundle.min.js"></script>
    <script>
        function initializeDataTable() {
            $('#example').DataTable({
                dom: 'Bfrtip',

                buttons: ['excel', 'print']
            });
        }


        $(document).ready(function () {
            initializeDataTable();
        });



        $(document).ready(function () {
            $('#Itemfk').on('mousedown', function () {
                $.ajax({
                    url: '@Url.Action("ItemList", "Admin")',
                    type: 'GET',
                    dataType: 'json',
                    success: function (data) {
                        var dropdown = $('#Itemfk');
                        dropdown.empty();
                        dropdown.append('<option selected disabled>Select Product</option>');
                        $.each(data, function () {
                            // dropdown.append($('<option></option>').attr('value', this.id).text(this.name));
                            dropdown.append($('<option></option>').attr('value', this.id).text(this.name + ' (' + this.id + ')'));

                        });
                    }
                });
            });
        });
    </script>

    <script>



        function openEditModal(Name, CuttingR, StretchingR, IorningR) {
            // Populate the modal fields with the row data
            $('#empId').val(Name);
            $('#CR').val(CuttingR);
            $('#SR').val(StretchingR);
            $('#IR').val(IorningR);



            // Open the edit modal
            $('#editModal').modal('show');
        }
        function saveChanges() {

            // Get the updated values from the modal fields
            const IName = $('#empId').val().trim();
            const CutR = $('#CR').val().trim()
            const StR = $('#SR').val().trim();
            const IronR = $('#IR').val().trim();

            const data =
            {
                Name: IName,
                CuttingR: CutR,
                StretchingR: StR,
                IorningR: IronR,

            };
            console.log(data);
            $.ajax({
                url: '/Admin/UpdateItemRate',
                type: 'POST',
                data: data,

                success: function (response) {
                    console.log(response);

                    // Close the modal
                    $('#editModal').modal('hide');
                    alert("Record Updated successfully.");
                    window.location.reload();
                }
            });
        }

    </script>

    <script>
        function sendSupplier() {
            var supplier = $('#supplier').val();
            $.ajax({
                type: "GET",
                url: "/Admin/GetEmployeeWorkSet",
                data: { supplier: supplier },
                success: function (response) {
                    console.log(response);
                    // Clear existing table data
                    if ($.fn.DataTable.isDataTable('#example')) {
                        $('#example').DataTable().destroy();
                    }
                    $('#example tbody').empty();
                    var sr=0
                    // Iterate over response data and append rows to the table
                    $.each(response.cartList, function (index, item) {
                        sr = sr + 1;
                        var row = '<tr>' +
                            '<td>' + sr + '</td>' +
                            '<td>' + item.itemName + '</td>' +
                            '<td>' + item.memoNo + '</td>' +
                            '<td>' + item.orderedQty + '</td>' +
                            '<td>' + item.completedQty + '</td>' +
                            '<td>' +
                            '<button onclick="openDeleteModal(' + item.srNO + ',' + item.measuremntId + ')" class="btn btn-borderless">' +
                            '<img src="/assets/images/Images3/deleteIcon.png" style="height: 20px;">' +
                            '</button>' +
                            '</td>' +
                            '</tr>';
                        $('#example tbody').append(row);
                    });
                    initializeDataTable();
                },
                error: function (error) {
                    console.error(error); // Handle errors
                }
            });
        }
    </script>



  @*   <script>
        function sendSupplier() {
            var supplier = $('#supplier').val();
            $.ajax({
                type: "GET",
                url: "/Admin/GetEmployeeWorkSet",
                data: { supplier: supplier },
                success: function (response) {
                    // Clear existing table data
                    $('#example tbody').empty();

                    // Iterate over response data and append rows to the table
                    $.each(response.cartList, function (index, item) {
                        var row = '<tr>' +
                            '<td>' + item.srNO + '</td>' +
                            '<td>' + item.itemName + '</td>' +
                            '<td>' + item.memoNo + '</td>' +
                            '<td>' + item.orderedQty + '</td>' +
                            '<td>' + item.completedQty + '</td>' +
                            '<td style="display: none;" class="hidden-srno">' + item.srNO + '</td>' +
                            '<td style="display: none;" class="hidden-measurement">' + item.measuremntId + '</td>' +
                            '<td>' +
                            '<button onclick="openDeleteModal($(this).closest(\'tr\').find(\'.hidden-srno\').text(), $(this).closest(\'tr\').find(\'.hidden-measurement\').text())" class="btn btn-borderless">' +
                            '<img src="/assets/images/Images3/deleteIcon.png" style="height: 20px;">' +
                            '</button>' +
                            '</td>' +
                            '</tr>';
                        $('#example tbody').append(row);
                    });
                },
                error: function (error) {
                    console.error(error); // Handle errors
                }
            });
        }
    </script> *@



    <script>
        var adcc = 0;
        var measurementId = 0;

        // Function to open the delete modal
        function openDeleteModal(srNO, measuremntId) {
            adcc = srNO;

            measurementId = measuremntId;
            $('#deleteModal').modal('show');
            $('#deleteModal .btn-danger').attr('data-item-id', adcc + '-' + MeasuremntId);
        }
        

        // Function to delete item
        function deleteEmployee() {
           
            $('#deleteModal').modal('hide');
          

            // Get the content of the td element
           
            $.ajax({
                url: '/Admin/DeleteItem', // URL of your backend controller action
                type: 'POST',
                data: { srNO: adcc, MeasuremntId: measurementId },
               // Pass both SrNO and MeasuremntId
                success: function (response) {
                    if (response.error == "डिलीट केले.") {
                        console.log(response.data);
                        document.getElementById("exampleModalLabel").innerHTML = "";
                        document.getElementById("alertmsg").innerHTML = "";


                        var mainmsg = document.getElementById("exampleModalLabel");

                        mainmsg.innerHTML = "";
                        mainmsg.innerHTML = "यशस्वीरित्या डिलीट";
                        mainmsg.style.color = "green";

                        var msgdiv = document.getElementById("alertmsg");
                        msgdiv.innerHTML = response.error;
                        msgdiv.style.color = "Black";

                        // Select the div element by its ID
                        var myDiv = document.getElementById("underline");

                        // Change the border style
                        myDiv.style.border = "2px solid green";

                        var modal = new bootstrap.Modal(document.getElementById('exampleModal'));
                        modal.show();

                        window.location.reload(); // Refresh the page on successful deletion
                    }
                    else {
                        document.getElementById("exampleModalLabel").innerHTML = "";
                        document.getElementById("alertmsg").innerHTML = "";


                        var mainmsg = document.getElementById("exampleModalLabel");

                        mainmsg.innerHTML = "ऑर्डर प्रती";
                        mainmsg.style.color = "red";

                        var msgdiv = document.getElementById("alertmsg");
                        msgdiv.innerHTML = response.error;
                        msgdiv.style.color = "Black";

                        // Select the div element by its ID
                        var myDiv = document.getElementById("underline");

                        // Change the border style
                        myDiv.style.border = "2px solid red";

                        var modal = new bootstrap.Modal(document.getElementById('exampleModal'));
                        modal.show();

                        //location.reload();
                    }

                },
                error: function (xhr, status, error) {
                    console.error(xhr.responseText); // Log any errors to the console
                }
            });
        }

        // Function to hide the modal
        function hideopenmodel() {
            $('#deleteModal').modal('hide');
        }

        function closepopupmodel() {
            $('#exampleModal').modal('hide');
            location.reload();
        }
    </script>




    <script>
        // Get the current date
        var currentDate = new Date();

        // Format the date
        var dateString = currentDate.toLocaleDateString("en-US", {
            year: 'numeric',
            month: 'long',
            day: 'numeric'
        });

        // Display the formatted date
        document.getElementById("date").innerHTML = dateString;
    </script>
    <script src="~/assets/libs/jquery/dist/jquery.min.js"></script>
    <script src="~/assets/libs/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/assets/js/sidebarmenu.js"></script>
    <script src="~/assets/js/app.min.js"></script>
    <script src="~/assets/libs/apexcharts/dist/apexcharts.min.js"></script>
    <script src="~/assets/libs/simplebar/dist/simplebar.js"></script>
    <script src="~/assets/js/dashboard.js"></script>

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://code.jquery.com/ui/1.13.0/jquery-ui.js"></script>
    <script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.js"></script>
    <script src="https://cdn.datatables.net/1.10.16/js/jquery.dataTables.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.32/pdfmake.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.32/vfs_fonts.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.4.2/js/dataTables.buttons.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.4.2/js/buttons.html5.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.2.1/js/buttons.print.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.3/jquery.validate.min.js"></script>



    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>

    <script>
        jQuery(function () {
            jQuery("#supplier").autocomplete({
                source: function (request, response) {
                    jQuery.ajax({
                        url: "/Admin/GetSupplierbyname",
                        dataType: "json",
                        data: { term: request.term },
                        success: function (data) {
                            response($.map(data, function (item) {
                                return {
                                    label: item.label,
                                    value: item.label,
                                    id: item.id
                                };
                            }));
                        },
                        error: function (jqXHR, textStatus, errorThrown) {
                            console.error('Error fetching data: ' + textStatus, errorThrown);
                        }
                    });
                },
                minLength: 2,
                select: function (event, ui) {
                    var Name = ui.item.label;
                    var Id = ui.item.id;
                    $("#Id").val(Id);

                    var newid = $("#Id").val();
                    // alert(newid);
                    // console.log("Selected Product: ", Name, " (ID: ", Id, ")");
                },
                open: function (event, ui) {
                    $(this).autocomplete("widget").position({
                        my: "left top",
                        at: "left bottom",
                        of: this
                    });
                    $(this).autocomplete("widget").outerWidth($(this).outerWidth());
                }
            });
        });
    </script>


</body>
</html>